(function(){var e,n;$(function(){return $(document).on("click","a.button.has_many_remove",function(e){var t,a;return e.preventDefault(),t=$(this).closest(".has_many_container"),a=$(this).closest("fieldset"),n(t),t.trigger("has_many_remove:before",[a]),a.remove()}),$(document).on("click","a.button.has_many_add",function(e){var t,a,r,i,o,s,d;return e.preventDefault(),a=$(this),s=a.closest(".has_many_container"),s.trigger(t=$.Event("has_many_add:before")),t.isDefaultPrevented()?void 0:(o=s.data("has_many_index")||s.children("fieldset").length-1,s.data({has_many_index:++o}),d=new RegExp(a.data("placeholder"),"g"),i=a.data("html").replace(d,o),r=$(i).insertBefore(this),n(s),s.trigger("has_many_add:after",[r]))}),$(document).on("change",'.has_many_container[data-sortable] :input[name$="[_destroy]"]',function(){return n($(this).closest(".has_many"))}),e(),$(document).on("has_many_add:after",".has_many_container",e)}),e=function(){var e;return e=$(".has_many_container[data-sortable]:not(.ui-sortable)"),e.sortable({items:"> fieldset",handle:"> ol > .handle",stop:n}),e.each(n)},n=function(e){var n,t;return e=e instanceof jQuery?e:$(this),n=e.data("sortable"),t=0,e.children("fieldset").each(function(){var e,a,r;return a=$(this),e=a.find("> ol > .input > :input[name$='[_destroy]']"),r=a.find("> ol > .input > :input[name$='["+n+"]']"),r.length?r.val(e.is(":checked")?"":t++):void 0})}}).call(this);